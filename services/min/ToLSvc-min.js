reader.service("ToLSvc",["$window","tarotDeck",function(t,i){function e(t,i,e){t.ray.origin.copy(r.position),t.ray.direction.set(i.x,i.y,.5).unproject(r).sub(r.position).normalize()}function o(t){if(n.activeCard=t.object,y){for(refCard in s)y.object.name==s[refCard].name&&w.to(y.object.position,1,s[refCard].position).to(".overlay",1,{opacity:"0"},"-=1").to(p.material,.7,{opacity:0},"-=1").to(p.position,.1,{z:-1}).to(".overlay",1,{visibility:"hidden"});y=null}else y=t,w.to(t.object.position,1,{x:-25,z:t.object.position.z+170}).to(".overlay",1,{visibility:"visible",opacity:"1"},"-=1").to(p.position,.2,{z:1},"-=1").to(p.material,1,{opacity:.7},"-=1")}var n=i.deck,s=i.shuffledDeck(),r,a,p,h=[],c=t.innerWidth/2,l=t.innerHeight/2,d=new THREE.Raycaster,u,f=new THREE.Vector2,y=null,w=new TimelineLite,g=!1,m=this,I=new THREE.WebGLRenderer({antialias:!0,autoClear:!0});this.mouse=f,this.renderer=I,this.init=function(){s[0].position={x:0,y:55,z:0},s[1].position={x:25,y:40,z:0},s[2].position={x:-25,y:40,z:0},s[3].position={x:25,y:15,z:0},s[4].position={x:-25,y:15,z:0},s[5].position={x:0,y:5,z:0},s[6].position={x:25,y:-20,z:0},s[7].position={x:-25,y:-20,z:0},s[8].position={x:0,y:-30,z:0},s[9].position={x:0,y:-55,z:0},s[0].posInfo="the subject's highest intelligence. It is part of Triangle 1, pointing upward, which represents spirituality, the highest ideal of the subject",s[1].posInfo="creative force, the 'father' card. It is part of Triangle 1, pointing upward, which represents spirituality, the highest ideal of the subject",s[2].posInfo="life, wisdom, the 'mother' card. It is part of Triangle 1, pointing upward, which represents spirituality, the highest ideal of the subject",s[3].posInfo="virtues, good qualities. It is part of Triangle 2, pointing downward, which represents the intellectual and moral nature of the subject",s[4].posInfo="conquest, intellectual or physical force. It is part of Triangle 2, pointing downward, which represents the intellectual and moral nature of the subject",s[5].posInfo="spirit of sacrifice, health. It is part of Triangle 2, pointing downward, which represents the intellectual and moral nature of the subject",s[6].posInfo="Venus, love, lust. It is part of Triangle 3, pointing downward, which represents the subject's subconsciousness - their intuition, desires and impulses",s[7].posInfo="procreation, arts, crafts. It is part of Triangle 3, pointing downward, which represents the subject's subconsciousness - their intuition, desires and impulses",s[8].posInfo="imagination, creative mental and physical forces. It is part of Triangle 3, pointing downward, which represents the subject's subconsciousness - their intuition, desires and impulses",s[9].posInfo="the physical body or the earthly home",I.setClearColor(16777215),I.setSize(t.innerWidth/12*10,t.innerHeight/12*10),$("#container-tree-of-life").append(I.domElement),a=new THREE.Scene,r=new THREE.PerspectiveCamera(35,t.innerWidth/t.innerHeight,1,1e4),r.position.set(0,0,230),a.add(r);var i=new THREE.AmbientLight(16777215);i.position.set(0,0,20),a.add(i);for(var e=new THREE.BoxGeometry(14,24,.2),o=[],n=(new THREE.TextureLoader).load(s[0].image),h=new THREE.MeshBasicMaterial({map:n}),c=0;10>c;c++){var l=(new THREE.TextureLoader).load(s[c].image),d=new THREE.MeshBasicMaterial({map:l}),u=new THREE.Mesh(e,d);u.position.set(-150,50,50),u.rotation.y=Math.PI/2,u.name=s[c].name,u.selected=!1,u.PKT=s[c].PKT,u.posInfo=s[c].posInfo,o.push(u),a.add(u)}w.to(o[0].position,1,s[0].position).to(o[0].rotation,1,{y:Math.PI},"-=1").to(o[1].position,1,s[1].position).to(o[1].rotation,1,{y:Math.PI},"-=1").to(o[2].position,1,s[2].position).to(o[2].rotation,1,{y:Math.PI},"-=1").to(o[3].position,1,s[3].position).to(o[3].rotation,1,{y:Math.PI},"-=1").to(o[4].position,1,s[4].position).to(o[4].rotation,1,{y:Math.PI},"-=1").to(o[5].position,1,s[5].position).to(o[5].rotation,1,{y:Math.PI},"-=1").to(o[6].position,1,s[6].position).to(o[6].rotation,1,{y:Math.PI},"-=1").to(o[7].position,1,s[7].position).to(o[7].rotation,1,{y:Math.PI},"-=1").to(o[8].position,1,s[8].position).to(o[8].rotation,1,{y:Math.PI},"-=1").to(o[9].position,1,s[9].position).to(o[9].rotation,1,{y:Math.PI},"-=1");var f=new THREE.PlaneGeometry(t.innerWidth/12*10,t.innerHeight/12*10),y=new THREE.MeshLambertMaterial({color:16777215,transparent:!0,opacity:0});p=new THREE.Mesh(f,y),p.name="overlay",p.position.set(0,0,-1),a.add(p)},$(t).resize(function(){r.aspect=t.innerWidth/t.innerHeight,r.updateProjectionMatrix(),I.setSize(t.innerWidth/12*10,t.innerHeight/12*10)}),this.intersect=function(t){e(d,f,r);var i=d.intersectObjects(a.children);i.length>0&&o(i[0])};var E=function(){r.position.x=20*f.x,r.position.y=20*f.y,r.lookAt(a.position),m.reqFr=requestAnimationFrame(E),I.render(a,r)};this.render=E,this.destroyScene=function(){cancelAnimationFrame(this.reqFr)}}]);